import requests
import ast


def fetch_event_market_clobs(event_slug: str):
    url = f"https://gamma-api.polymarket.com/events?slug={event_slug}"
    response = requests.get(url).json()[0]
    mapping = {}

    for market in response["markets"]:
        token_ids = ast.literal_eval(market["clobTokenIds"])
        mapping[market["slug"]] = {"yes": token_ids[0], "no": token_ids[1]}

    return mapping


def fetch_event_market_slugs(event_slug: str):
    url = f"https://gamma-api.polymarket.com/events?slug={event_slug}"
    response = requests.get(url).json()[0]
    slugs = []

    for market in response["markets"]:
        slugs.append(market["slug"])

    return slugs


def fetch_events_all():
    url = "https://gamma-api.polymarket.com/events?closed=false"
    response = requests.get(url).json()
    slugs = []
    for event in response:
        slugs.append(event["slug"])
    return slugs


print(fetch_events_all())

# Example output:
# {
#     "will-donald-trump-be-times-person-of-the-year-for-2025": {
#         "yes": "1891139530288101466360827889001064386176078694605601493533714481162107118833",
#         "no": "29001918619173663784731936150697210647086718376927619349891594131652792158865",
#     },
#     "will-elon-musk-be-times-person-of-the-year-for-2025": {
#         "yes": "37592573364246481528037283320306899889740654585611919942245962624349713112547",
#         "no": "56608004021650347355918617009524935868546889107996621545580318470596953052863",
#     },
#     "will-personthing-c-be-times-person-of-the-year-for-2025": {
#         "yes": "61586389394971435967549597175548847897310831994219689891504340398010581163811",
#         "no": "115662724736156492390652754818029454113441347016751747130673456822265018498369",
#     },
#     "will-personthing-e-be-times-person-of-the-year-for-2025": {
#         "yes": "72313048300440588858232071678940695679834911972779391894748920817593525959870",
#         "no": "54880122642903978810290301764511044148716925721352723024248000062597824137295",
#     },
#     "will-xi-jinping-be-times-person-of-the-year-for-2025": {
#         "yes": "60832796533714919667805926129703562670320904476104736289780745946932968698309",
#         "no": "32829733560041181103849457314424353221801819438852257507428608166418440964428",
#     },
#     "will-personthing-f-be-times-person-of-the-year-for-2025": {
#         "yes": "43323721733972903434727236842374217910864488049095654123924464879877398920735",
#         "no": "87850747648215752816170619579856918800907418533360348150943952812298852044060",
#     },
#     "will-pope-francis-be-times-person-of-the-year-for-2025": {
#         "yes": "49774001562624358195744702892966990055921437051379946424547911220196789699061",
#         "no": "52355136321155982981770237271856054964824336082881762505873560206090302646977",
#     },
#     "will-jerome-powell-be-times-person-of-the-year-for-2025": {
#         "yes": "3642081727560954218031797897978141656002571698971305459667763235629581180678",
#         "no": "25098093917403666186591594434085875322958337119141799505145033665042547325747",
#     },
#     "will-volodymyr-zelenskyy-be-times-person-of-the-year-for-2025": {
#         "yes": "25031066648705069862276695634486631939712281906796647729948632417639418903403",
#         "no": "88493815951920653677643509776437251899817724245590761869555265256006581806740",
#     },
#     "will-taylor-swift-be-times-person-of-the-year-for-2025": {
#         "yes": "85234879976825459752677980148652206218254342645636610918600755409606393140063",
#         "no": "727739253264631506158192099422636240138537362597969243140595195372461231711",
#     },
#     "will-artificial-intelligence-be-times-person-of-the-year-for-2025": {
#         "yes": "97738289848450488297763027547275619371606557963137023790940218654157116963791",
#         "no": "104393896768735558690178711391531744820971355331117822134769475143370127085506",
#     },
#     "will-personthing-i-be-times-person-of-the-year-for-2025": {
#         "yes": "14570706499501429816296773141934572098322682000420874549684693901767259528857",
#         "no": "62350838654714186602117950835239189596112516384622167224675515373979328496808",
#     },
#     "will-lebron-james-be-times-person-of-the-year-for-2025": {
#         "yes": "22660463552745828059828440374615279792253436618366221337095213796497078581471",
#         "no": "80590832284581480717903625437092927220175196303935715067251503251994631198663",
#     },
#     "will-personthing-j-be-times-person-of-the-year-for-2025": {
#         "yes": "103683624037814057075469256620415249584783580696204349548021985051474503879525",
#         "no": "98391568441932320099777952472939899442141743286656363983753690831387256454640",
#     },
#     "will-pope-leo-xiv-be-times-person-of-the-year-for-2025": {
#         "yes": "105653102834452620371409325814533961616743949229659860748137091341544163414196",
#         "no": "30674798812428880166145494562540271253062183749829279693492436262829588871153",
#     },
#     "will-benjamin-netanyahu-be-times-person-of-the-year-for-2025": {
#         "yes": "4053265010403135722623170267447599397180690994919260235009027300557922933785",
#         "no": "62962145755443637372303788686924623377239207408200061537662223548483752503815",
#     },
#     "will-zohran-mamdani-be-times-person-of-the-year-for-2025": {
#         "yes": "99816988957668550853014893727169808463502648657840731431642246556873570725652",
#         "no": "56005766828496512062518895029144935642035794136464316162874248812771971622184",
#     },
#     "will-another-personthing-be-times-person-of-the-year-for-2025-523": {
#         "yes": "90866668422502903738140420072322970483361882923072806503189788157356285010777",
#         "no": "476104187756163513955058378263148608028322334559398017025364052817699947015",
#     },
# }